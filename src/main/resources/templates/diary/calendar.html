<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Mood Calendar - Daily You</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
        }

        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body class="bg-slate-900 text-slate-100 min-h-screen">

    <nav class="fixed top-0 w-full z-50 glass border-b border-white/5">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a th:href="@{/dashboard}" class="flex items-center gap-3 hover:text-blue-400 transition">
                    <i class="fas fa-arrow-left"></i>
                    <span class="font-bold">Back to Dashboard</span>
                </a>
                <span class="font-semibold text-lg" th:text="${monthName} + ' ' + ${year}">January 2024</span>
            </div>
        </div>
    </nav>

    <div class="pt-24 pb-12 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Controls -->
        <div class="flex justify-between items-center mb-6">
            <a th:href="@{/diary/calendar(year=${month == 1 ? year - 1 : year}, month=${month == 1 ? 12 : month - 1})}"
                class="p-2 hover:bg-white/10 rounded-full transition">
                <i class="fas fa-chevron-left"></i>
            </a>
            <h2 class="text-2xl font-bold" th:text="${monthName} + ' ' + ${year}">JANUARY 2026</h2>
            <a th:href="@{/diary/calendar(year=${month == 12 ? year + 1 : year}, month=${month == 12 ? 1 : month + 1})}"
                class="p-2 hover:bg-white/10 rounded-full transition">
                <i class="fas fa-chevron-right"></i>
            </a>
        </div>

        <div class="glass rounded-3xl p-6">
            <!-- Weekday Headers -->
            <div class="grid grid-cols-7 gap-1 mb-2 text-center text-slate-400 text-sm font-medium">
                <div>Mon</div>
                <div>Tue</div>
                <div>Wed</div>
                <div>Thu</div>
                <div>Fri</div>
                <div>Sat</div>
                <div>Sun</div>
            </div>

            <!-- Days Grid -->
            <div class="grid grid-cols-7 gap-2 auto-rows-fr">

                <div th:each="day : ${days}"
                    class="relative aspect-square rounded-xl bg-slate-800/50 flex flex-col items-center justify-center border border-white/5 overflow-hidden transition hover:border-white/20 group">

                    <!-- Empty Slot -->
                    <div th:if="${day == null}" class="w-full h-full bg-transparent"></div>

                    <!-- Actual Day -->
                    <div th:if="${day != null}" class="w-full h-full relative p-1">
                        <span class="absolute top-2 left-3 text-sm z-10 font-medium" th:text="${day}">1</span>

                        <!-- Check if entry exists -->
                        <div th:if="${entryMap.containsKey(day)}" th:with="entry=${entryMap.get(day)}"
                            class="w-full h-full flex flex-col">

                            <!-- Image Background -->
                            <div th:if="${entry.imagePath}" class="absolute inset-0 z-0">
                                <img th:src="@{${entry.imagePath}}"
                                    src="https://images.unsplash.com/photo-1493723843684-a63e6d1622ae?q=80&w=600&auto=format&fit=crop"
                                    class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                            </div>

                            <!-- Mood Overlay (if no image or always visible?) -->
                            <div th:unless="${entry.imagePath}" class="absolute inset-0 z-0 opacity-40"
                                th:style="'background-color: ' + ${entry.mood.colorCode}"></div>

                            <!-- Actions (on hover) -->
                            <a th:href="@{/diary/edit/{id}(id=${entry.id})}"
                                class="absolute inset-0 z-20 bg-black/60 opacity-0 group-hover:opacity-100 flex items-center justify-center transition cursor-pointer text-white gap-3">
                                <i class="fas fa-pen"></i>
                            </a>
                        </div>

                        <!-- No Entry: Add Button -->
                        <a th:unless="${entryMap.containsKey(day)}"
                            th:href="@{/diary/form(date=${year} + '-' + ${#numbers.formatInteger(month,2)} + '-' + ${#numbers.formatInteger(day,2)})}"
                            class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-hover:bg-white/5 transition text-slate-400 hover:text-white">
                            <i class="fas fa-plus"></i>
                        </a>

                    </div>
                </div>
            </div>
        </div>

    </div>
</body>

</html>